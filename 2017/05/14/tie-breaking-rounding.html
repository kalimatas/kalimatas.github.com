<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/static/css/style.css" type="text/css" />
	<link rel="stylesheet" href="/static/css/pygments.css" type="text/css" />
	<link rel="icon" type="image/x-icon" href="favicon.ico">
	<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Tie-breaking Rounding | Alexander Guz’s blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Tie-breaking Rounding" />
<meta name="author" content="Alexander Guz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So I was reading an article about differences between Python 2 and Python 3 1, and there was a statement: The key differences between Python 2.7.x and Python 3.x with examples &#8617;" />
<meta property="og:description" content="So I was reading an article about differences between Python 2 and Python 3 1, and there was a statement: The key differences between Python 2.7.x and Python 3.x with examples &#8617;" />
<link rel="canonical" href="https://guzalexander.com/2017/05/14/tie-breaking-rounding.html" />
<meta property="og:url" content="https://guzalexander.com/2017/05/14/tie-breaking-rounding.html" />
<meta property="og:site_name" content="Alexander Guz’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-14T16:14:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Tie-breaking Rounding" />
<meta name="twitter:site" content="@kalimatas" />
<meta name="twitter:creator" content="@Alexander Guz" />
<script type="application/ld+json">
{"headline":"Tie-breaking Rounding","dateModified":"2017-05-14T16:14:00+02:00","datePublished":"2017-05-14T16:14:00+02:00","url":"https://guzalexander.com/2017/05/14/tie-breaking-rounding.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://guzalexander.com/2017/05/14/tie-breaking-rounding.html"},"author":{"@type":"Person","name":"Alexander Guz"},"description":"So I was reading an article about differences between Python 2 and Python 3 1, and there was a statement: The key differences between Python 2.7.x and Python 3.x with examples &#8617;","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

	<section class="container">
		<nav class="menu">
			<ul>
				<li><a class="nav-link fancy-hover" href="/"><span>Home</span></a></li>
				<li><a class="nav-link fancy-hover" href="/archive/"><span>Archive</span></a></li>
				<li><a class="nav-link fancy-hover" href="/about/"><span>About</span></a></li>
			</ul>
			<ul>
				<li>
					<a class="nav-link fancy-hover" href="https://twitter.com/kalimatas" target="_blank" >
						<span>
							<img alt="Twitter" width="18" height="18" title="Twitter" src="/static/img/twitter_new.svg" />
						</span>
					</a>
				</li>
				<li>
					<a class="nav-link fancy-hover" href="https://github.com/kalimatas" target="_blank">
						<span>
							<img alt="GitHub" width="18" height="18" title="GitHub" src="/static/img/github_new.svg" />
						</span>
					</a>
				</li>
				<li>
					<a class="nav-link fancy-hover" href="https://linkedin.com/in/kalimatas" target="_blank" >
						<span>
							<img alt="LinkedIn" width="18" height="18" title="LinkedIn" src="/static/img/linkedin_new.svg" />
						</span>
					</a>
				</li>
			</ul>
		</nav>

		<section class="main-wrapper">
			<section class="main">
				<article>
	
	<h1><span>Tie-breaking Rounding</span></h1>
	<section class="post-meta">
		
		<time>May 14, 2017</time> • <span class="reading-time" title="Estimated read time">
  
  
    4 mins read
  
</span>

	</section>
	
	<section id="article-content">
		<p>So I was reading an article about differences between Python 2 and Python 3 <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup>, and there was a statement:</p>

<blockquote>
  <p>Python 3 adopted the now standard way of rounding decimals when it results in a tie (.5) at the last significant digits. Now, in Python 3, decimals are rounded to the nearest even number.</p>
</blockquote>

<p>At this point, I was like “WTF?!”. At school I was taught a simple rule: if x is exactly half-way between two integers - round to the largest absolute value, i.e. 13.5 becomes 14, and -13.5 becomes -14. No magic with even/odd numbers. It wasn’t even discussed, that there are might be different ways of rounding.</p>

<p>But, as it often happens with school program, they didn’t tell us all the truth.</p>

<p>There are actually six more or less normal ways and two not so normal, thus leaving us with eight (eight, Carl!) rules of rounding.</p>

<p>These are the <em>normal</em> rules <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup>:</p>

<ul>
  <li>Round half down (or towards negative infinity): 13.5 rounds to 13, -13.5 rounds to -14.</li>
  <li>Round half up (or towards positive infinity): 13.5 rounds to 14, -13.5 rounds to -13.</li>
  <li>Round half towards zero: 13.5 rounds to 13, -13.5 rounds to -13.</li>
  <li>Round half away from zero: 13.5 rounds to 14, -13.5 rounds to -14. <em>I believe, this is the rule I was taught at school</em>.</li>
  <li>Round half to even: 13.5 rounds to 14, -13.5 rounds to -14, but 14.5 <em>also rounds</em> to 14, and -14.5 rounds to -14.</li>
  <li>Round half to odd: Opposite of the previous rule. 13.5 rounds to 13, -13.5 rounds to -13, 14.5 rounds to 15, -14.5 rounds to -15.</li>
</ul>

<p>And these are some <em>not so normal</em>:</p>

<ul>
  <li>Stochastic rounding: the choice of the result is… <em>random</em>!.</li>
  <li>Alternating tie-breaking: this just alternate round up and round down for.</li>
</ul>

<h2 id="rounding-in-programming-languages">Rounding in programming languages</h2>

<p>Just out of curiousity I checked how rounding works in a few popular programming languages. It seems like most of them use <em>Round half away from zero</em> rule, the most logical for me, since I was taught it as school.</p>

<p>So, this is what you’ll get in C, PHP 7, Python 2, Ruby 2:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// C's printf</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"%g -&gt; %g, %g -&gt; %g, %g -&gt; %g, %g -&gt; %g</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> 
    <span class="mi">13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="mi">13</span><span class="p">.</span><span class="mi">5</span><span class="p">),</span> <span class="mi">14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">.</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">.</span><span class="mi">5</span><span class="p">),</span> <span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">.</span><span class="mi">5</span><span class="p">));</span>

<span class="c1">// output: 13.5 -&gt; 14, 14.5 -&gt; 15, -14.5 -&gt; -15, -13.5 -&gt; -14</span></code></pre></figure>

<p>But, as was already mentioned, Python3 uses <em>Round half to even</em>, and it will be:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">'%.1f -&gt; %d, %.1f -&gt; %d, %.1f -&gt; %d, %.1f -&gt; %d'</span> \
<span class="p">...</span> <span class="o">%</span> <span class="p">(</span><span class="mf">13.5</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mf">13.5</span><span class="p">),</span> <span class="mf">14.5</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mf">14.5</span><span class="p">),</span> <span class="o">-</span><span class="mf">14.5</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="mf">14.5</span><span class="p">),</span> <span class="o">-</span><span class="mf">13.5</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="mf">13.5</span><span class="p">)))</span>

<span class="o">//</span> <span class="n">output</span><span class="p">:</span> <span class="mf">13.5</span> <span class="o">-&gt;</span> <span class="mi">14</span><span class="p">,</span> <span class="mf">14.5</span> <span class="o">-&gt;</span> <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.5</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.5</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mi">14</span></code></pre></figure>

<p>What’s more surprising for me is that Java 8 also uses another rule - I guess it is <em>Round half towards zero</em>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%.1f -&gt; %d, %.1f -&gt; %d, %.1f -&gt; %d, %.1f -&gt; %d\n"</span><span class="o">,</span>
    <span class="mf">13.5</span><span class="o">,</span> <span class="nc">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(</span><span class="mf">13.5</span><span class="o">),</span> <span class="mf">14.5</span><span class="o">,</span> <span class="nc">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(</span><span class="mf">14.5</span><span class="o">),</span> <span class="o">-</span><span class="mf">14.5</span><span class="o">,</span> <span class="nc">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(-</span><span class="mf">14.5</span><span class="o">),</span> <span class="o">-</span><span class="mf">13.5</span><span class="o">,</span> <span class="nc">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(-</span><span class="mf">13.5</span><span class="o">));</span>

<span class="c1">// output: 13.5 -&gt; 14, 14.5 -&gt; 15, -14.5 -&gt; -14, -13.5 -&gt; -13</span></code></pre></figure>

<p>Go 1.8 doesn’t have built-in round function at all <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote">3</a></sup>, you have to choose from <a href="https://golang.
org/pkg/math/#Ceil">math.Ceil</a> or <a href="https://golang.org/pkg/math/#Floor">math.Floor</a> yourself.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Well, beware of different rules in different programming languages!</p>

<h2 id="notes">Notes</h2>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><a href="http://sebastianraschka.com/Articles/2014_python_2_3_key_diff.html#bankers-rounding">The key differences between Python 2.7.x and Python 3.x with examples</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>On Wikipedia you can find <a href="https://en.wikipedia.org/wiki/Rounding#Tie-breaking">more information</a> about the rules. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><a href="https://github.com/golang/go/issues/4594">Suggestion</a> to add <code class="language-plaintext highlighter-rouge">Round</code> function. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

	</section>
	<section id="share-page">
	<span>Share this page on</span>
	<a href="https://twitter.com/intent/tweet?text=Tie-breaking Rounding&url=https://guzalexander.com/2017/05/14/tie-breaking-rounding.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter">Twitter</a> or
	<a href="https://www.reddit.com/submit?url=https://guzalexander.com/2017/05/14/tie-breaking-rounding.html&title=Tie-breaking Rounding" rel="nofollow" target="_blank" title="Share on Reddit">Reddit</a>
</section>

</article>


			</section>

			<footer class="main-footer">
				<section class="copyright">&copy; Copyright 2021 by Alexander Guz • <a target="_blank" href="/feed.xml">RSS</a></section>
				<section>Built with <a target="_blank" href="https://jekyllrb.com/">Jekyll</a></section>
			</footer>
		</section>
	</section>

	<script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-31916607-1']);
		_gaq.push(['_setDomainName', 'guzalexander.com']);
		_gaq.push(['_trackPageview']);

		(function () {
            var ga = document.createElement('script');ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' === document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga, s);
		})();
	</script>

</body>

</html>
